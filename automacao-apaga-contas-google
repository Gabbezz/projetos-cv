import pyautogui
import time
import sys

# --- CONFIGURAÇÕES OBRIGATÓRIAS ---

# 1. Substitua pelas coordenadas que você encontrou
POS_TRES_PONTOS   = (703, 375)  # Onde estão os 3 pontos do PRIMEIRO perfil
POS_MENU_EXCLUIR  = (666, 440)  # Onde está o item "Excluir" do menu
POS_BOTAO_FINAL   = (1177, 715)  # Onde está o botão "Excluir" de confirmação

# 2. Defina quantos perfis você quer excluir
QUANTIDADE_DE_PERFIS = 119  # Mude este número

# 3. Pausas (em segundos) - Aumente se o script for rápido demais
PAUSA_MENU = 0.5   # Tempo para o menu de 3 pontos aparecer
PAUSA_POPUP = 0.5  # Tempo para a janela de confirmação aparecer
PAUSA_REFLUXO = 1.0 # Tempo para o próximo perfil "subir" para o lugar

# -----------------------------------------------

try:
    pyautogui.FAILSAFE = True
    print("Iniciando automação em 5 segundos...")
    print(f"O script está configurado para excluir {QUANTIDADE_DE_PERFIS} perfis.")
    print("Mova o mouse para o canto da tela para PARAR A QUALQUER MOMENTO.")
   
    # Pausa de segurança para você clicar na janela do Chrome
    time.sleep(5)
    print("INICIANDO...")

    # Loop principal: vai repetir a quantidade de vezes que você definiu
    for i in range(QUANTIDADE_DE_PERFIS):
        print(f"Excluindo perfil {i + 1} de {QUANTIDADE_DE_PERFIS}...")
       
        # Ação 1: Clicar nos 3 pontos
        pyautogui.click(POS_TRES_PONTOS)
        time.sleep(PAUSA_MENU)
       
        # Ação 2: Clicar em "Excluir" no menu
        pyautogui.click(POS_MENU_EXCLUIR)
        time.sleep(PAUSA_POPUP)
       
        # Ação 3: Clicar em "Excluir" na confirmação
        pyautogui.click(POS_BOTAO_FINAL)
       
        # Pausa mais longa para o perfil ser excluído e o próximo
        # perfil da lista "subir" e ocupar o lugar do que foi apagado.
        time.sleep(PAUSA_REFLUXO)

    print(f"\n--- SCRIPT CONCLUÍDO ---")
    print(f"Total de {QUANTIDADE_DE_PERFIS} perfis foram processados.")

except Exception as e:
    print(f"\n!!!!!!!! ERRO ENCONTRADO !!!!!!!!\n")
    print(e)
except pyautogui.FailSafeException:
    print("\nSAÍDA DE EMERGÊNCIA ATIVADA. Script interrompido.")
finally:
    print("\nPressione ENTER para fechar a janela...")
    input()
